<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Mỹ phẩm </title>
  <meta name="description" content="Danh mục Mỹ phẩm — hiển thị sản phẩm từ affiliates.json"/>
  <link rel="canonical" href="https://tuyetlethi83a.github.io/store/my-pham.html"/>
  <meta name="robots" content="index,follow"/>
  <meta property="og:title" content="Mỹ phẩm "/>
  <meta property="og:description" content="Danh mục Mỹ phẩm — hiển thị sản phẩm từ affiliates.json"/>
  <meta property="og:url" content="https://tuyetlethi83a.github.io/store/my-pham.html"/>
  <meta property="og:image" content="https://tuyetlethi83a.github.io/assets/og/default-og.webp"/>
  <link rel="stylesheet" href="/assets/site.css"/>
  <script defer src="/assets/analytics.js"></script>
  <script defer src="/assets/mxd-affiliate.js"></script>
</head>
<body>
<header class="container">
  <nav><a href="/store.html" class="btn">← Cửa hàng</a></nav>
  <h1>Mỹ phẩm</h1>
</header>

<div class="container">
  <div id="grid" class="product-grid"><p>Đang tải…</p></div>
</div>

<script>
function priceText(v){ const n=Number(v); return Number.isFinite(n)? n.toLocaleString('vi-VN')+' ₫' : ''; }
function cardHtml(p){
  const priceRaw = p.price_vnd ?? p.price;
  const price = priceText(priceRaw);
  const origin = p.origin_url ?? p.origin ?? '#';
  return `
    <div class="card product-card">
      <a class="product-meta" href="${origin}" data-merchant="${p.merchant||''}" data-sku="${p.sku}" data-img="${p.image||''}" ${Number.isFinite(Number(priceRaw))?`data-price="${Number(priceRaw)}"`:''}>${p.name}</a>
      <img src="${p.image}" alt="${p.name}"/>
      ${price?`<p><strong>${price}</strong></p>`:''}
      <p><span class="badge">${p.merchant||''}</span></p>
      <p><a class="btn buy" href="#">Mua tại nơi gốc</a></p>
    </div>`;
}
(async () => {
  try{
    const res = await fetch('/affiliates.json',{cache:'no-store'});
    const list = await res.json();
    const items = list.filter(p => (p.category||'').startsWith('my-pham'));
    document.getElementById('grid').innerHTML = items.length ? items.map(cardHtml).join('') : '<p>Chưa có sản phẩm.</p>';
  }catch(e){
    document.getElementById('grid').innerHTML = '<p>Lỗi tải dữ liệu.</p>';
  }
})();
</script>
</body>
</html>
